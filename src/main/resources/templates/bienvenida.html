<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlazaChina - Bienvenida</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .carousel-container {
            position: relative;
            overflow: hidden;
        }
        .carousel-slide {
            display: none;
            transition: opacity 1s ease-in-out;
        }
        .carousel-slide.active {
            display: block;
        }
        .carousel-nav {
            position: absolute;
            bottom: 18px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
        }
        .carousel-dot {
            height: 14px;
            width: 14px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            border: none;
            outline: none;
            transition: background 0.2s;
        }
        .carousel-dot.active {
            background-color: #fff;
            border: 2px solid #f97316;
        }
        .card-shadow {
            box-shadow: 0 4px 16px 0 rgba(0,0,0,0.10), 0 2px 4px 0 rgba(0,0,0,0.06);
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">

    <!-- NAVBAR -->
    <nav class="bg-white shadow-md p-4 flex justify-between items-center">
        <div class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-red-500 flex items-center gap-2">
            <i class="bi bi-shop"></i> PlazaChina
        </div>
        <div class="flex items-center space-x-4">
            <a href="/bienvenida" class="text-gray-700 hover:text-orange-600 font-medium flex items-center gap-1">
                <i class="bi bi-house-door"></i> Inicio
            </a>
            <a href="/productos" class="text-gray-700 hover:text-orange-600 font-medium flex items-center gap-1">
                <i class="bi bi-box"></i> Productos
            </a>
            <a href="/carrito" class="relative flex items-center gap-1 text-gray-700 hover:text-orange-600 font-medium">
                <i class="bi bi-cart"></i>
                <span th:if="${carritoCount > 0}" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center" th:text="${carritoCount}">0</span>
            </a>
            <form method="post" action="/logout" class="inline">
                <button type="submit" class="text-red-600 hover:text-red-800 font-medium flex items-center gap-1">
                    <i class="bi bi-box-arrow-right"></i> Cerrar Sesión
                </button>
            </form>
        </div>
    </nav>

    <!-- HEADER CON DEGRADADO -->
    <header class="py-14 text-center bg-gradient-to-r from-orange-500 to-red-500">
        <h1 class="text-4xl md:text-5xl font-extrabold text-white flex items-center justify-center gap-3 drop-shadow-lg">
            <i class="bi bi-shop"></i> ¡Bienvenido a Plaza China!
        </h1>
        <p class="text-white text-lg mt-3 font-medium drop-shadow" style="font-size: 14px;">Todo lo que necesitas en un solo lugar</p>
    </header>

    <main class="flex-grow container mx-auto px-4 md:px-8">
        <!-- Carrusel -->
        <section class="mb-12 mt-[-60px]">
            <div class="carousel-container rounded-2xl overflow-hidden shadow-2xl bg-white mx-auto max-w-5xl relative">
                <div class="carousel-slide active">
                    <img src="https://images.unsplash.com/photo-1604719312566-8912e9227c6a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Imagen 1" class="w-full h-72 md:h-96 object-cover object-center">
                </div>
                <div class="carousel-slide">
                    <img src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Imagen 2" class="w-full h-72 md:h-96 object-cover object-center">
                </div>
                <div class="carousel-slide">
                    <img src="https://images.unsplash.com/photo-1556740738-b6a63e27c4df?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Imagen 3" class="w-full h-72 md:h-96 object-cover object-center">
                </div>
                <div class="carousel-nav">
                    <button class="carousel-dot active" onclick="currentSlide(0)"></button>
                    <button class="carousel-dot" onclick="currentSlide(1)"></button>
                    <button class="carousel-dot" onclick="currentSlide(2)"></button>
                </div>
            </div>
        </section>

        <!-- Productos en Oferta -->
        <section class="mb-12">
            <h2 class="text-3xl font-semibold text-gray-800 mb-6 text-center">Productos en Oferta</h2>
            <div th:if="${#lists.isEmpty(productosEnOferta)}" class="text-center text-gray-600 text-lg py-5">
                No hay productos en oferta actualmente.
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <div th:each="producto : ${productosEnOferta}" class="bg-white rounded-2xl overflow-hidden card-shadow hover:shadow-xl transition-shadow duration-300 ease-in-out flex flex-col">
                    <img th:src="${producto.imagenUrl != null and producto.imagenUrl != '' ? producto.imagenUrl : 'https://placehold.co/400x300/E0E0E0/6A11CB?text=Oferta'}"
                         alt="Producto en oferta" class="w-full h-48 object-cover object-center">
                    <div class="p-5 flex flex-col flex-grow">
                        <h3 class="text-xl font-semibold text-gray-800 mb-2" th:text="${producto.nombre}">Nombre Producto</h3>
                        <div class="flex items-baseline mb-3">
                            <span class="text-red-500 font-bold text-lg mr-2"
                                  th:text="'S/ ' + ${#numbers.formatDecimal(producto.precio * (1 - producto.descuento/100), 1, 'COMMA', 2, 'POINT')}">S/ XX.XX</span>
                            <span class="line-through text-gray-500 text-sm"
                                  th:text="'S/ ' + ${#numbers.formatDecimal(producto.precio, 1, 'COMMA', 2, 'POINT')}">S/ YY.YY</span>
                            <span class="ml-2 bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded-full"
                                  th:text="${#numbers.formatDecimal(producto.descuento, 0, 0) + '% OFF'}">XX% OFF</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">Stock: <span th:text="${producto.stock}"></span></p>
                        <a href="#" class="mt-auto inline-block bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold py-2 px-4 rounded-xl transition duration-300 ease-in-out transform hover:scale-105"
                           th:attr="data-id=${producto.id},data-nombre=${producto.nombre},data-imagenurl=${producto.imagenUrl},data-precio=${producto.precio},data-descuento=${producto.descuento},data-stock=${producto.stock},data-descripcion=${producto.descripcion},data-marca=${producto.marca},data-categoria=${producto.categoria.descripcion},data-unidad=${producto.unidadMedida}"
                           onclick="showProductDetailsModal(this); return false;">
                            Ver Detalles
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer personalizado -->
    <footer class="bg-[#232b34] text-white pt-10 pb-4 mt-8">
        <div class="container mx-auto px-4 md:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 pb-6 border-b border-gray-700">
                <!-- Plaza China Ica -->
                <div>
                    <h3 class="text-xl font-bold text-red-400 mb-4">Plaza China Ica</h3>
                    <ul class="space-y-2 text-gray-200">
                        <li><i class="bi bi-geo-alt-fill mr-2"></i>Av. Municipalidad #233, Ica</li>
                        <li><i class="bi bi-telephone-fill mr-2"></i>(056) 123456</li>
                        <li><i class="bi bi-whatsapp mr-2"></i>+51 987 654 321</li>
                        <li><i class="bi bi-envelope-fill mr-2"></i>contacto@plazachinaica.com</li>
                    </ul>
                </div>
                <!-- Horario -->
                <div>
                    <h3 class="text-xl font-bold text-red-400 mb-4">Horario</h3>
                    <ul class="space-y-2 text-gray-200">
                        <li><span class="font-bold">Lunes a Viernes:</span> 9:00 AM - 8:00 PM</li>
                        <li><span class="font-bold">Sábados:</span> 9:00 AM - 9:00 PM</li>
                        <li><span class="font-bold">Domingos:</span> 9:00 AM - 6:00 PM</li>
                    </ul>
                </div>
                <!-- Enlaces -->
                <div>
                    <h3 class="text-xl font-bold text-red-400 mb-4">Enlaces</h3>
                    <ul class="space-y-2 text-gray-200">
                        <li><a href="/nosotros" class="hover:text-red-400 flex items-center gap-1"><i class="bi bi-people"></i> Nosotros</a></li>
                        <li><a href="/productos" class="hover:text-red-400 flex items-center gap-1"><i class="bi bi-box"></i> Productos</a></li>
                        <li><a href="/contacto" class="hover:text-red-400 flex items-center gap-1"><i class="bi bi-envelope"></i> Contacto</a></li>
                        <li><a href="/terminos" class="hover:text-red-400 flex items-center gap-1"><i class="bi bi-file-earmark-text"></i> Términos y condiciones</a></li>
                    </ul>
                </div>
                <!-- Síguenos -->
                <div>
                    <h3 class="text-xl font-bold text-red-400 mb-4">Síguenos</h3>
                    <div class="flex space-x-4 mb-3">
                        <a href="https://www.facebook.com/plazachinaica/?locale=es_LA" class="hover:text-red-400 text-2xl"><i class="bi bi-facebook"></i></a>
                        <a href="https://www.instagram.com/reel/DDTZvdxMEbn/" class="hover:text-red-400 text-2xl"><i class="bi bi-instagram"></i></a>
                        <a href="https://www.tiktok.com/@plazachinacenter.oficial" class="hover:text-red-400 text-2xl"><i class="bi bi-tiktok"></i></a>
                        <a href="#" class="hover:text-red-400 text-2xl"><i class="bi bi-youtube"></i></a>
                    </div>
                    <div class="text-gray-200 mb-1">Métodos de pago</div>
                    <div class="flex space-x-4 text-2xl">
                        <i class="bi bi-credit-card"></i>
                        <i class="bi bi-paypal"></i>
                        <i class="bi bi-cash-coin"></i>
                    </div>
                </div>
            </div>
            <div class="text-center text-gray-400 text-sm mt-6">
                &copy; 2025 Plaza China Ica. Todos los derechos reservados.<br>
                Desarrollado con <i class="bi bi-heart-fill text-red-400"></i> para los clientes de Ica
            </div>
        </div>
    </footer>

    <!-- Modal de Detalles de Producto -->
    <div id="productDetailsModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-2xl shadow-xl max-w-lg w-full relative">
            <button onclick="hideProductDetailsModal()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            <div class="flex flex-col md:flex-row gap-6">
                <img id="modal-imagen" src="" alt="Imagen del producto" class="w-48 h-48 object-cover object-center rounded-xl mx-auto md:mx-0">
                <div class="flex-1">
                    <h3 id="modal-nombre" class="text-2xl font-bold text-gray-800 mb-2">Nombre Producto</h3>
                    <div class="flex items-baseline mb-2">
                        <span id="modal-precio-descuento" class="text-red-500 font-bold text-lg mr-2"></span>
                        <span id="modal-precio-original" class="line-through text-gray-500 text-sm"></span>
                        <span id="modal-descuento" class="ml-2 bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded-full"></span>
                    </div>
                    <p id="modal-descripcion" class="text-gray-700 mb-2"></p>
                    <p class="text-gray-600 text-sm mb-1">Stock: <span id="modal-stock"></span></p>
                    <p class="text-gray-600 text-sm mb-1">Marca: <span id="modal-marca"></span></p>
                    <p class="text-gray-600 text-sm mb-1">Categoría: <span id="modal-categoria"></span></p>
                    <p class="text-gray-600 text-sm mb-1">Unidad: <span id="modal-unidad"></span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let slideIndex = 0;
        const slides = document.querySelectorAll('.carousel-slide');
        const dots = document.querySelectorAll('.carousel-dot');
        let slideTimeout;

        function showSlides() {
            slides.forEach(slide => slide.style.display = 'none');
            dots.forEach(dot => dot.classList.remove('active'));
            slideIndex++;
            if (slideIndex > slides.length) {slideIndex = 1}
            slides[slideIndex-1].style.display = 'block';
            dots[slideIndex-1].classList.add('active');
            slideTimeout = setTimeout(showSlides, 5000);
        }

        function currentSlide(n) {
            clearTimeout(slideTimeout);
            slides.forEach(slide => slide.style.display = 'none');
            dots.forEach(dot => dot.classList.remove('active'));
            slideIndex = n + 1;
            if (slideIndex > slides.length) {slideIndex = 1}
            if (slideIndex < 1) {slideIndex = slides.length}
            slides[slideIndex-1].style.display = 'block';
            dots[slideIndex-1].classList.add('active');
            slideTimeout = setTimeout(showSlides, 5000);
        }

        function showProductDetailsModal(button) {
            document.getElementById('productDetailsModal').classList.remove('hidden');
            document.getElementById('modal-nombre').innerText = button.dataset.nombre;
            document.getElementById('modal-imagen').src = button.dataset.imagenurl && button.dataset.imagenurl !== 'null' ? button.dataset.imagenurl : 'https://placehold.co/400x300/E0E0E0/6A11CB?text=Producto';
            const precio = parseFloat(button.dataset.precio);
            const descuento = parseFloat(button.dataset.descuento);
            if (descuento > 0) {
                const precioConDescuento = precio * (1 - descuento / 100);
                document.getElementById('modal-precio-descuento').innerText = `S/ ${precioConDescuento.toFixed(2)}`;
                document.getElementById('modal-precio-original').innerText = `S/ ${precio.toFixed(2)}`;
                document.getElementById('modal-descuento').innerText = `${descuento.toFixed(0)}% OFF`;
                document.getElementById('modal-precio-original').classList.remove('hidden');
                document.getElementById('modal-descuento').classList.remove('hidden');
            } else {
                document.getElementById('modal-precio-descuento').innerText = `S/ ${precio.toFixed(2)}`;
                document.getElementById('modal-precio-original').innerText = '';
                document.getElementById('modal-descuento').innerText = '';
                document.getElementById('modal-precio-original').classList.add('hidden');
                document.getElementById('modal-descuento').classList.add('hidden');
            }
            document.getElementById('modal-descripcion').innerText = button.dataset.descripcion;
            document.getElementById('modal-stock').innerText = button.dataset.stock;
            document.getElementById('modal-marca').innerText = button.dataset.marca;
            document.getElementById('modal-categoria').innerText = button.dataset.categoria;
            document.getElementById('modal-unidad').innerText = button.dataset.unidad;
        }

        function hideProductDetailsModal() {
            document.getElementById('productDetailsModal').classList.add('hidden');
        }

        showSlides();
    </script>
</body>
</html>